# RovLink

可扩展标准水下机器人通信指令集

## 概述

本协议是供兼容FinNAV（LibROV）框架的机器人（包括但不限于水下机器人）使用的控制层解耦指令集，规定了上位机与机器人、机器人内部APU与MCU间数据传输格式。

本协议旨在为机器人的智能控制算法和执行控制部分提供统一的数据传输格式，实现除视觉部分电控系统的解耦

本仓库包含RovLink协议的说明文档 `doc` 、示例代码 `example` 、基础指令分类 `isa` 、旧版协议存档 `lagency` 、示例软件 `tools` 等

协议规定了三个层次：

* 物理层：协议能够支持的数据总线标准
* 传输层：协议在上位机、机器人内部进行传输时的路由标准
* 应用层：协议支持传输的机器人传感器数据和上位机控制指令的具体存储方式

RovLink不包含物理层，其底层数据传输是由具体的总线协议完成的

## 物理层

RovLink可以使用如下通用板级总线传输：

* 标准TTL（3.3V/5V）串口
* 标准RS232串口

RovLink可以使用如下现场总线传输：

* 标准RS485串口
* 标准RS422串口
* CAN总线
* 百兆/千兆ETH以太网

## 传输层

RovLink具有两种基本帧格式

* **标准帧** `StandardDataFrame`：**上位机和机器人主控之间必须使用标准帧传输**，机器人内部可以选择传输标准帧或内部帧
* **内部帧** `InnerDataFrame`：**机器人内部使用CAN总线互联时，只能使用内部帧**，其他情况下，可选使用标准帧

> 到目前为止，两种帧的差别只有帧头识别码和帧尾校验码。后续更新中会考虑加入指令压缩

在MCU互联中，可根据帧特征码（特征指示-设备ID）进行舱间路由，协议最多可支持 `15` 个设备间的互联

## 应用层

RovLink依托FinNAV（LibROV）实现了一套基础编解码协议，基本功能包括：

* 标准帧、内部帧打包
* 标准帧、内部帧解包
* 标准帧-内部帧转换
* Payload解析和编码
* 帧特征码识别

> 目前未完全实现的功能包括：
>
> * 指令压缩和译码
> * 标准帧、内部帧扩展
> * 自动化生成新数据格式

## 历史版本

本指令集基于旧版指令构建，旧版内容可参考 `Lagency` 目录下的  `ControlFormat_Lagency.xlsx` 和 `DataFormat_Lagency.xlsx`